name: â–¶ï¸ Deploy CDK Application

on:
    workflow_dispatch:
      inputs:
        branch:
          description: 'Branch para deploy'
          required: true
          default: 'main'
          type: choice
          options:
            - main
            - develop
            - staging
    push:
      branches:
        - main
    pull_request:
      branches:
        - main
jobs:
    deploy:
      runs-on: ubuntu-latest
      
      steps:
        - uses: actions/checkout@v3
        
        - name: ğŸ” Setup Node.js
          uses: actions/setup-node@v3
          with:
            node-version: '18'
            
        - name: ğŸ” Install Dependencies
          run: npm install
          
        - name: ğŸ”¨ Build
          run: npm run build
      
        - name: ğŸ« Deploy to Vercel
          uses: amondnet/vercel-action@v20
          with:
            vercel-token: ${{ secrets.VERCEL_TOKEN }}
            vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
            vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
            working-directory: ./
            vercel-args: '--prod'
